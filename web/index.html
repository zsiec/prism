<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Prism Viewer</title>
	<style>
		* { margin: 0; padding: 0; box-sizing: border-box; }
		body {
			background: #000;
			color: #e0e0e0;
			font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
			display: flex;
			flex-direction: column;
			min-height: 100vh;
		}
		header {
			padding: 0 1rem;
			height: 40px;
			width: 100%;
			display: flex;
			justify-content: space-between;
			align-items: center;
			border-bottom: 1px solid #1a1a1a;
			flex-shrink: 0;
			background: #0a0a0a;
			transition: height 0.15s ease;
		}
		.header-left {
			display: flex;
			align-items: center;
			gap: 1rem;
		}
		h1 {
			font-family: 'SF Mono', 'Menlo', monospace;
			font-size: 0.85rem;
			font-weight: 700;
			letter-spacing: 1px;
			text-transform: uppercase;
			color: #e2e8f0;
		}

		.tabs {
			display: flex;
			gap: 1px;
			background: #111;
			border-radius: 3px;
			padding: 2px;
		}
		.tab {
			padding: 4px 14px;
			border-radius: 3px;
			font-size: 0.75rem;
			font-weight: 600;
			cursor: pointer;
			color: #64748b;
			transition: all 0.15s ease;
			border: none;
			background: transparent;
			letter-spacing: 0.03em;
			font-family: 'SF Mono', monospace;
		}
		.tab:hover { color: #94a3b8; }
		.tab.active {
			background: #1e40af;
			color: #fff;
		}

		.controls {
			display: flex;
			gap: 0.4rem;
			align-items: center;
		}
		input {
			background: #111;
			border: 1px solid #222;
			color: #e0e0e0;
			padding: 0.3rem 0.7rem;
			border-radius: 3px;
			font-size: 0.8rem;
			font-family: 'SF Mono', monospace;
			width: 180px;
		}
		input:focus { outline: none; border-color: #2563eb; }
		button.primary {
			background: #1e40af;
			color: white;
			border: none;
			padding: 0.3rem 1rem;
			border-radius: 3px;
			cursor: pointer;
			font-size: 0.8rem;
			font-weight: 600;
			font-family: 'SF Mono', monospace;
			letter-spacing: 0.3px;
		}
		button.primary:hover { background: #2563eb; }
		button.primary:disabled { background: #222; color: #555; cursor: not-allowed; }

		#status {
			text-align: center;
			padding: 0.35rem;
			color: #475569;
			font-size: 0.75rem;
			font-family: 'SF Mono', monospace;
			flex-shrink: 0;
		}
		.streams {
			display: flex;
			gap: 0.3rem;
			flex-wrap: wrap;
			justify-content: center;
			padding: 0 1rem;
			flex-shrink: 0;
		}
		.stream-tag {
			background: #111;
			border: 1px solid #222;
			padding: 0.2rem 0.6rem;
			border-radius: 3px;
			font-size: 0.7rem;
			font-family: 'SF Mono', monospace;
			cursor: pointer;
			transition: border-color 0.15s;
			color: #94a3b8;
		}
		.stream-tag:hover { border-color: #2563eb; color: #e2e8f0; }

		#singleMode {
			display: flex;
			flex-direction: column;
			align-items: center;
			flex: 1;
		}
		.player {
			max-width: 960px;
			width: 100%;
			margin: 0.5rem auto;
		}
		canvas { width: 100%; border-radius: 3px; }

		#multiMode {
			display: none;
			flex: 1;
		}

	.player:fullscreen {
		max-width: none;
		margin: 0;
		background: #000;
		display: flex;
		align-items: center;
		justify-content: center;
	}
	.player:fullscreen canvas { max-height: 100vh; border-radius: 0; }

	.cc-region { margin: 0; padding: 2px 4px; max-width: 90%; overflow: hidden; word-wrap: break-word; }
	.cc-708-region { position: absolute; border-radius: 2px; }
	.cc-608-line { white-space: pre; }
	.cc-line {
		padding: 2px 6px;
		display: inline-block;
		box-sizing: border-box;
	}
	.cc-608-line.cc-line { background: rgba(0,0,0,0.75); }
	.cc-708-region .cc-line { display: block; }
		.cc-flash { animation: cc-blink 1s step-start infinite; }
		@keyframes cc-blink { 50% { opacity: 0; } }

		.audio-btn, .cc-btn {
			background: rgba(0,0,0,0.6);
			color: #94a3b8;
			border: 1px solid #444;
			padding: 4px 10px;
			border-radius: 4px;
			cursor: pointer;
			font-size: 13px;
			font-weight: 600;
			letter-spacing: 0.5px;
			white-space: nowrap;
		}
		.audio-btn:hover, .cc-btn:hover { color: #fff; border-color: #fff; background: rgba(0,0,0,0.8); }
		.cc-btn.cc-active { color: #fff; border-color: #fff; text-decoration: underline; text-underline-offset: 3px; }

		.audio-menu, .cc-menu {
			position: absolute;
			bottom: calc(100% + 6px);
			right: 0;
			background: rgba(15,23,42,0.95);
			border: 1px solid #333;
			border-radius: 3px;
			padding: 4px 0;
			min-width: 120px;
			max-height: 300px;
			overflow-y: auto;
		}
		.audio-menu-item, .cc-menu-item {
			padding: 6px 16px;
			cursor: pointer;
			font-size: 13px;
			color: #ccc;
			white-space: nowrap;
		}
		.audio-menu-item:hover, .cc-menu-item:hover { background: rgba(255,255,255,0.1); color: #fff; }
		.audio-menu-item.active, .cc-menu-item.active { color: #fff; font-weight: 600; }
		.audio-menu-sep { height: 1px; background: #333; margin: 4px 8px; }
		.audio-menu-loudness { color: #60a5fa; }

		button.secondary {
			background: transparent;
			color: #94a3b8;
			border: 1px solid #333;
			padding: 0.3rem 0.8rem;
			border-radius: 3px;
			cursor: pointer;
			font-size: 0.8rem;
			font-weight: 600;
			font-family: 'SF Mono', monospace;
			letter-spacing: 0.3px;
		}
		button.secondary:hover { color: #e2e8f0; border-color: #555; }

		.modal-overlay {
			display: none;
			position: fixed;
			inset: 0;
			background: rgba(0,0,0,0.7);
			z-index: 1000;
			align-items: center;
			justify-content: center;
		}
		.modal-overlay.visible { display: flex; }
		.modal {
			background: #111;
			border: 1px solid #333;
			border-radius: 6px;
			padding: 1.5rem;
			width: 380px;
			max-width: 90vw;
		}
		.modal h2 {
			font-family: 'SF Mono', monospace;
			font-size: 0.9rem;
			font-weight: 700;
			color: #e2e8f0;
			margin-bottom: 1rem;
			letter-spacing: 0.5px;
		}
		.modal-field {
			margin-bottom: 0.8rem;
		}
		.modal-field label {
			display: block;
			font-size: 0.7rem;
			font-family: 'SF Mono', monospace;
			color: #64748b;
			margin-bottom: 0.3rem;
			letter-spacing: 0.3px;
		}
		.modal-field input {
			width: 100%;
		}
		.modal-hint {
			font-size: 0.65rem;
			color: #475569;
			margin-top: 0.2rem;
			font-family: 'SF Mono', monospace;
		}
		.modal-actions {
			display: flex;
			gap: 0.5rem;
			justify-content: flex-end;
			margin-top: 1.2rem;
		}
		.modal-error {
			color: #ef4444;
			font-size: 0.75rem;
			font-family: 'SF Mono', monospace;
			margin-top: 0.5rem;
			display: none;
		}
		.modal-error.visible { display: block; }
	</style>
</head>
<body>
	<header>
		<div class="header-left">
			<h1>Prism</h1>
			<div class="tabs">
				<button class="tab active" data-mode="single">Single Stream</button>
				<button class="tab" data-mode="multi">Multiview</button>
			</div>
		</div>
		<div class="controls">
			<button class="secondary" id="srtPullBtn">Pull SRT</button>
			<input id="streamKey" type="text" placeholder="Stream key" value="">
			<button class="primary" id="connectBtn">Watch</button>
		</div>
	</header>

	<div id="status">Enter a stream key and click Watch, or switch to Multiview.</div>
	<div class="streams" id="streamList"></div>

	<div id="singleMode">
		<div class="player" id="player"></div>
	</div>

	<div id="multiMode"></div>

	<div class="modal-overlay" id="srtPullModal">
		<div class="modal">
			<h2>Pull SRT Stream</h2>
			<div class="modal-field">
				<label>SRT Address</label>
				<input id="srtAddress" type="text" placeholder="host:port" value="">
				<div class="modal-hint">Remote SRT listener address (e.g. 192.168.1.100:9000)</div>
			</div>
			<div class="modal-field">
				<label>Stream Key</label>
				<input id="srtStreamKey" type="text" placeholder="my-stream" value="">
				<div class="modal-hint">Name for the stream in Prism</div>
			</div>
			<div class="modal-field">
				<label>SRT Stream ID (optional)</label>
				<input id="srtStreamId" type="text" placeholder="live/my-stream" value="">
				<div class="modal-hint">SRT StreamID sent to remote. Default: live/{stream key}</div>
			</div>
			<div class="modal-error" id="srtPullError"></div>
			<div class="modal-actions">
				<button class="secondary" id="srtPullCancel">Cancel</button>
				<button class="primary" id="srtPullConnect">Connect &amp; Watch</button>
			</div>
		</div>
	</div>

	<script type="module" src="/src/main.ts"></script>
</body>
</html>
